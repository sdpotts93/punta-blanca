var TheDatepicker;!function(t){var e=function(){};t.CannotParseDateException=e;var n=function(){function t(){this.day=null,this.month=null,this.year=null}return t.prototype.createDate=function(){if(null===this.day||null===this.month||null===this.year)throw new e;var t=new Date(this.year,this.month-1,this.day);if(isNaN(t.getTime()))throw new e;for(;t.getDate()!==this.day||t.getMonth()!==this.month-1||t.getFullYear()!==this.year;){if(!(this.day>28))throw new e;this.day--,t=new Date(this.year,this.month-1,this.day)}return t},t}(),i=function(){function t(t){this.options_=t,this.escapeChar_="\\"}return t.prototype.formatDate_=function(t,e){if(!e)return null;for(var n=!1,i="",o=0;o<t.length;o++){var r=t.substring(o,o+1);if(n)i+=r,n=!1;else if(r!==this.escapeChar_){var s=this.getFormatter_(r);i+=s?s.call(this,e):r}else n=!0}return i},t.prototype.parseDate_=function(t,i){if(""===i)return null;for(var o=new n,r=!1,s=0,a=0;a<t.length;a++){var l=t.substring(a,a+1);if(r)r=!1;else{if(l===this.escapeChar_){r=!0;continue}var h=this.getParser_(l);if(h){try{s+=h.call(this,i.substring(s),o)}catch(t){if(!(t instanceof e))throw t;if(" "===i.substring(s,s+1)){s++,a--;continue}throw t}continue}}var p=i.substring(s,s+1);if(p!==l){if(" "===l)continue;if(" "===p){s++,a--;continue}throw new e}s++}return o.createDate()},t.prototype.getFormatter_=function(t){switch(t){case"j":return this.formatDay_;case"d":return this.formatDayWithLeadingZero_;case"D":return this.formatDayOfWeekTextual_;case"l":return this.formatDayOfWeekTextualFull_;case"n":return this.formatMonth_;case"m":return this.formatMonthWithLeadingZero_;case"F":return this.formatMonthTextual_;case"M":return this.formatMonthTextualShort_;case"Y":return this.formatYear_;case"y":return this.formatYearTwoDigits_;default:return null}},t.prototype.formatDay_=function(t){return t.getDate()+""},t.prototype.formatDayWithLeadingZero_=function(t){return("0"+t.getDate()).slice(-2)},t.prototype.formatDayOfWeekTextual_=function(t){return this.options_.translator.translateDayOfWeek(t.getDay())},t.prototype.formatDayOfWeekTextualFull_=function(t){return this.options_.translator.translateDayOfWeekFull(t.getDay())},t.prototype.formatMonth_=function(t){return t.getMonth()+1+""},t.prototype.formatMonthWithLeadingZero_=function(t){return("0"+(t.getMonth()+1)).slice(-2)},t.prototype.formatMonthTextual_=function(t){return this.options_.translator.translateMonth(t.getMonth())},t.prototype.formatMonthTextualShort_=function(t){return this.options_.translator.translateMonthShort(t.getMonth())},t.prototype.formatYear_=function(t){return t.getFullYear()+""},t.prototype.formatYearTwoDigits_=function(t){var e=t.getFullYear()+"";return e.substring(e.length-2)},t.prototype.getParser_=function(t){switch(t){case"j":case"d":return this.parseDay_;case"D":return this.parseDayOfWeekTextual_;case"l":return this.parseDayOfWeekTextualFull_;case"n":case"m":return this.parseMonth_;case"F":return this.parseMonthTextual_;case"M":return this.parseMonthTextualShort_;case"Y":return this.parseYear_;case"y":return this.parseYearTwoDigits_;default:return null}},t.prototype.parseDay_=function(t,n){for(var i=0;"0"===t.substring(0,1);)t=t.substring(1),i++;var o=t.substring(0,2);if(!/[12][0-9]|3[01]/.test(o)&&(o=o.substring(0,1),!/[1-9]/.test(o)))throw new e;return n.day=parseInt(o,10),i+o.length},t.prototype.parseDayOfWeekTextual_=function(t){var e=this;return this.parseDayOfWeekByTranslator_(t,(function(t){return e.options_.translator.translateDayOfWeek(t)}))},t.prototype.parseDayOfWeekTextualFull_=function(t){var e=this;return this.parseDayOfWeekByTranslator_(t,(function(t){return e.options_.translator.translateDayOfWeekFull(t)}))},t.prototype.parseDayOfWeekByTranslator_=function(t,e){for(var n=0,i=0;i<7;i++){var o=e(i);if(n=Math.max(n,o.length),t.substring(0,o.length).toLowerCase()===o.toLowerCase())return o.length}for(var r=0;/[a-zA-Z]/.test(t.substring(0,1))&&(t=t.substring(1),++r!==n););return r},t.prototype.parseMonth_=function(t,n){for(var i=0;"0"===t.substring(0,1);)t=t.substring(1),i++;var o=t.substring(0,2);if("10"!==o&&"11"!==o&&"12"!==o&&(o=o.substring(0,1),!/[1-9]/.test(o)))throw new e;return n.month=parseInt(o,10),i+o.length},t.prototype.parseMonthTextual_=function(t,e){var n=this;return this.parseMonthByTranslator_(t,e,(function(t){return n.options_.translator.translateMonth(t)}))},t.prototype.parseMonthTextualShort_=function(t,e){var n=this;return this.parseMonthByTranslator_(t,e,(function(t){return n.options_.translator.translateMonthShort(t)}))},t.prototype.parseMonthByTranslator_=function(t,n,i){for(var o=1;o<=12;o++){var r=i(o-1);if(t.substring(0,r.length).toLowerCase()===r.toLowerCase())return n.month=o,r.length}throw new e},t.prototype.parseYear_=function(t,n){var i=!1;"-"===t.substring(0,1)&&(i=!0,t=t.substring(1));for(var o=0;/[0-9]/.test(t.substring(o,o+1));)o++;if(0===o)throw new e;var r=parseInt(t.substring(0,o),10);return i&&(r=-r),n.year=r,o+(i?1:0)},t.prototype.parseYearTwoDigits_=function(t,n){var i=t.substring(0,2);if(!/[0-9]{2}/.test(i))throw new e;var o=this.options_.getToday().getFullYear()+"",r=o.substring(0,o.length-2);return n.year=parseInt(r+i,10),2},t}();t.DateConverter_=i}(TheDatepicker||(TheDatepicker={})),function(t){var e;!function(t){t[t.Untouched=0]="Untouched",t[t.Waiting=1]="Waiting",t[t.Ready=2]="Ready",t[t.Initialized=3]="Initialized",t[t.Destroyed=4]="Destroyed"}(e||(e={}));var n=function(){function n(n,i,o){if(void 0===i&&(i=null),void 0===o&&(o=null),this.initializationPhase_=e.Untouched,this.inputListenerRemover_=null,this.listenerRemovers_=[],this.deselectElement_=null,n&&!t.Helper_.isElement_(n))throw new Error("Input was expected to be null or an HTMLElement.");if(i&&!t.Helper_.isElement_(i))throw new Error("Container was expected to be null or an HTMLElement.");if(!n&&!i)throw new Error("At least one of input or container is mandatory.");if(o&&!(o instanceof t.Options))throw new Error("Options was expected to be an instance of Options");this.document_=document,this.options=o?o.clone():new t.Options;var r="There is already a datepicker present on ";if(this.isContainerExternal_=!!i,i){if(i.datepicker)throw new Error(r+"container.")}else i=this.createContainer_(),n&&n.parentNode.insertBefore(i,n.nextSibling);if(n){if(n.datepicker)throw new Error(r+"input.");n.datepicker=this}this.isInputTextBox_=n&&("undefined"==typeof HTMLInputElement||n instanceof HTMLInputElement)&&"text"===n.type,this.isInputTextBox_&&(n.autocomplete="off"),i.datepicker=this,this.input=n,this.container=i,this.dateConverter_=new t.DateConverter_(this.options),this.viewModel_=new t.ViewModel_(this.options,this,this.dateConverter_),this.triggerReady_(n),this.triggerReady_(i)}return n.prototype.render=function(){var n=this;switch(this.initializationPhase_){case e.Ready:return this.initListeners_(),this.initializationPhase_=e.Initialized,void this.render();case e.Waiting:return this.createDeselectElement_(),this.options.isHiddenOnBlur()?void(this.viewModel_.selectPossibleDate_()||this.updateInput_()):void this.open();case e.Untouched:if(this.preselectFromInput_(),this.createDeselectElement_(),this.viewModel_.selectInitialDate_(null)||this.updateInput_(),this.input&&this.options.isHiddenOnBlur())return this.input===this.document_.activeElement?(this.initializationPhase_=e.Ready,this.render(),void this.open()):(this.inputListenerRemover_=t.Helper_.addEventListener_(this.input,t.ListenerType_.Focus,(function(t){n.open(t)})),void(this.initializationPhase_=e.Waiting));this.initializationPhase_=e.Ready,this.render();default:return void this.viewModel_.render_()}},n.prototype.open=function(t){return void 0===t&&(t=null),this.initializationPhase_===e.Untouched&&this.render(),this.initializationPhase_===e.Waiting&&(this.initializationPhase_=e.Ready,this.render(),n.hasClickedViewModel_=!0),!!n.activateViewModel_(t,this)&&(this.input&&this.input.focus(),!0)},n.prototype.isOpened=function(){return this.viewModel_.isActive_()},n.prototype.close=function(t){return void 0===t&&(t=null),!this.viewModel_.isActive_()||!!n.activateViewModel_(t,null)&&(this.input&&this.input.blur(),!0)},n.prototype.reset=function(t){return void 0===t&&(t=null),this.viewModel_.reset_(t)},n.prototype.destroy=function(){if(this.initializationPhase_!==e.Destroyed){for(var t=0;t<this.listenerRemovers_.length;t++)this.listenerRemovers_[t]();this.listenerRemovers_=[],this.isContainerExternal_?this.container.innerHTML="":this.container.parentNode.removeChild(this.container),delete this.container.datepicker,this.input&&(delete this.input.datepicker,this.removeInitialInputListener_(),this.input=null),this.deselectElement_&&(this.deselectElement_.parentNode.removeChild(this.deselectElement_),this.deselectElement_=null),this.initializationPhase_=e.Destroyed}},n.prototype.isDestroyed=function(){return this.initializationPhase_===e.Destroyed},n.prototype.selectDate=function(e,n,i){return void 0===n&&(n=!0),void 0===i&&(i=null),this.viewModel_.selectDay_(i,t.Helper_.normalizeDate_("Date",e,!0,this.options),!!n)},n.prototype.getSelectedDate=function(){return this.viewModel_.selectedDate_?new Date(this.viewModel_.selectedDate_.getTime()):null},n.prototype.getSelectedDateFormatted=function(){return this.dateConverter_.formatDate_(this.options.getInputFormat(),this.viewModel_.selectedDate_)},n.prototype.getCurrentMonth=function(){return new Date(this.viewModel_.getCurrentMonth_().getTime())},n.prototype.goToMonth=function(e,n){return void 0===n&&(n=null),this.viewModel_.goToMonth_(n,t.Helper_.normalizeDate_("Month",e,!1,this.options))},n.prototype.parseRawInput=function(){return this.isInputTextBox_?this.dateConverter_.parseDate_(this.options.getInputFormat(),this.input.value):null},n.prototype.getDay=function(e){return this.viewModel_.createDay_(t.Helper_.normalizeDate_("Date",e,!1,this.options))},n.prototype.readInput_=function(e){if(void 0===e&&(e=null),!this.isInputTextBox_)return!1;try{var n=this.parseRawInput();return n?this.viewModel_.selectNearestDate_(e,n):this.viewModel_.cancelSelection_(e)}catch(e){if(!(e instanceof t.CannotParseDateException))throw e;return!1}},n.prototype.updateInput_=function(){if(this.isInputTextBox_&&this.input!==this.document_.activeElement&&(this.input.value=this.dateConverter_.formatDate_(this.options.getInputFormat(),this.viewModel_.selectedDate_)||"",this.deselectElement_)){var t=this.options.isDeselectButtonShown()&&""!==this.input.value;this.deselectElement_.style.visibility=t?"visible":"hidden"}},n.onDatepickerReady=function(e,i){if(void 0===i&&(i=null),!t.Helper_.isElement_(e))throw new Error("Element was expected to be an HTMLElement.");i=t.Helper_.checkFunction_("Callback",i);var o=null,r=null;return"undefined"!=typeof Promise&&(o=new Promise((function(t){r=t}))),e.datepicker&&e.datepicker instanceof n?(e.datepicker.triggerReadyListener_(i,e),r&&r(e.datepicker)):n.readyListeners_.push({promiseResolve:r,element:e,callback:i}),o},n.prototype.createContainer_=function(){var t=this.document_.createElement("div");return t.className=this.options.prefixClass_("container"),t.style.position="absolute",t.style.zIndex="99",t},n.prototype.createDeselectElement_=function(){var e=this;if(!this.isInputTextBox_||!this.options.isDeselectButtonShown()||this.deselectElement_)return null;var n=this.document_.createElement("span");n.style.position="absolute";var i=this.document_.createElement("a");i.innerHTML=this.options.getDeselectHtml();var o=this.options.translator.translateTitle(t.TitleName.Deselect);""!==o&&(i.title=o),i.style.position="relative",i.style.left="-0.8em",i.href="#",i.onclick=function(n){n=n||window.event,t.Helper_.preventDefault_(n),e.viewModel_.cancelSelection_(n)},n.className=this.options.prefixClass_("deselect"),i.className=this.options.prefixClass_("deselect-button"),n.appendChild(i),this.input.parentNode.insertBefore(n,this.input.nextSibling),this.deselectElement_=n},n.prototype.preselectFromInput_=function(){if(this.isInputTextBox_)try{var e=this.parseRawInput();e&&this.options.setInitialDate(e)}catch(e){if(!(e instanceof t.CannotParseDateException))throw e}},n.prototype.initListeners_=function(){var e=this;if(!n.areGlobalListenersInitialized_){var i=function(t){n.hasClickedViewModel_?n.hasClickedViewModel_=!1:n.activateViewModel_(t,null)};t.Helper_.addEventListener_(this.document_,t.ListenerType_.MouseDown,i),t.Helper_.addEventListener_(this.document_,t.ListenerType_.FocusIn,i),t.Helper_.addEventListener_(this.document_,t.ListenerType_.KeyDown,(function(t){n.activeViewModel_&&n.activeViewModel_.triggerKeyPress_(t)})),n.areGlobalListenersInitialized_=!0}this.removeInitialInputListener_();var o=function(t){n.activateViewModel_(t,e),n.hasClickedViewModel_=!0};this.listenerRemovers_.push(t.Helper_.addEventListener_(this.container,t.ListenerType_.MouseDown,o)),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.container,t.ListenerType_.FocusIn,o)),this.deselectElement_&&(this.listenerRemovers_.push(t.Helper_.addEventListener_(this.deselectElement_,t.ListenerType_.MouseDown,o)),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.deselectElement_,t.ListenerType_.FocusIn,o))),this.input&&(this.listenerRemovers_.push(t.Helper_.addEventListener_(this.input,t.ListenerType_.MouseDown,o)),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.input,t.ListenerType_.Focus,o)),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.input,t.ListenerType_.Blur,(function(){e.updateInput_()}))),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.input,t.ListenerType_.KeyDown,(function(e){t.Helper_.stopPropagation_(e)}))),this.listenerRemovers_.push(t.Helper_.addEventListener_(this.input,t.ListenerType_.KeyUp,(function(t){e.readInput_(t)}))))},n.prototype.removeInitialInputListener_=function(){this.inputListenerRemover_&&(this.inputListenerRemover_(),this.inputListenerRemover_=null)},n.prototype.triggerReady_=function(t){for(var e=n.readyListeners_.length-1;e>=0;e--){var i=n.readyListeners_[e];i.element===t&&(this.triggerReadyListener_(i.callback,t),i.promiseResolve&&i.promiseResolve(this),n.readyListeners_.splice(e,1))}},n.prototype.triggerReadyListener_=function(t,e){t&&t.call(e,this,e)},n.prototype.fixPosition_=function(){if(!this.isContainerExternal_&&this.initializationPhase_!==e.Destroyed){var t=window.pageYOffset||this.document_.documentElement.scrollTop,n=window.pageXOffset||this.document_.documentElement.scrollLeft,i=null,o=null;window.visualViewport&&(i=window.visualViewport.height,o=window.visualViewport.width);for(var r=t+(i||window.innerHeight||Math.max(this.document_.documentElement.clientHeight,this.document_.body.clientHeight)||0),s=n+(o||window.innerWidth||Math.max(this.document_.documentElement.clientWidth,this.document_.body.clientWidth)||0),a=0,l=0,h=this.input;h&&!isNaN(h.offsetLeft)&&!isNaN(h.offsetTop);)a+=h.offsetTop-(h.scrollTop||0),l+=h.offsetLeft-(h.scrollLeft||0),h=h.offsetParent;var p=null;this.options.isPositionFixingEnabled()&&this.container.childNodes.length>0&&((p=this.container.childNodes[0]).style.position="",p.style.top="",p.style.left="");var u=this.input.offsetWidth,_=this.input.offsetHeight,c=a+_,d=l+u,f=this.container.offsetHeight,y=this.container.offsetWidth,m="",g=a-t>f&&r-c<f,v=l-n>y-u&&s-d<y-u;if(g&&(m+=" "+this.options.prefixClass_("container--over")),v&&(m+=" "+this.options.prefixClass_("container--left")),this.container.className=this.options.prefixClass_("container")+m,p&&(g||v)){if(g){var D=_+f;p.style.top="-"+D+"px"}if(v){var w=y-u;p.style.left="-"+w+"px"}p.style.position="absolute"}}},n.activateViewModel_=function(t,e){var i=e?e.viewModel_:null,o=n.activeViewModel_;return o===i||!(o&&!o.setActive_(t,!1))&&(n.activeViewModel_!==o||(i?!!i.setActive_(t,!0)&&(n.activeViewModel_!==o||(e.fixPosition_(),n.activeViewModel_=i),!0):(n.activeViewModel_=null,!0)))},n.readyListeners_=[],n.areGlobalListenersInitialized_=!1,n.activeViewModel_=null,n.hasClickedViewModel_=!1,n}();t.Datepicker=n,t.onDatepickerReady=n.onDatepickerReady}(TheDatepicker||(TheDatepicker={})),function(t){var e=function(){function e(e,n,i){this.isToday=!1,this.isPast=!1,this.isAvailable=!0,this.isInValidity=!0,this.isVisible=!1,this.isInCurrentMonth=!1,this.isSelected=!1,this.isHighlighted=!1,this.isFocused=!1,this.dayNumber=e.getDate(),this.month=e.getMonth()+1,this.year=e.getFullYear(),this.dayOfWeek=e.getDay(),this.isWeekend=this.dayOfWeek===t.DayOfWeek.Saturday||this.dayOfWeek===t.DayOfWeek.Sunday,this.createDay_=n,this.formatDate_=i}return e.prototype.getDate=function(){return new Date(this.year,this.month-1,this.dayNumber,0,0,0,0)},e.prototype.getFormatted=function(){return this.year+"-"+("0"+this.month).slice(-2)+"-"+("0"+this.dayNumber).slice(-2)},e.prototype.getInputFormatted=function(){return this.formatDate_(this.getDate())},e.prototype.isEqualToDate=function(e){return t.Helper_.isValidDate_(e)&&this.dayNumber===e.getDate()&&this.month===e.getMonth()+1&&this.year===e.getFullYear()},e.prototype.isEqualToDay=function(t){return t instanceof e&&this.dayNumber===t.dayNumber&&this.month===t.month&&this.year===t.year},e.prototype.getSibling=function(e){void 0===e&&(e=1);var n=this.getDate();return n.setDate(n.getDate()+t.Helper_.checkNumber_("Shift",e)),this.createDay_(n)},e}();t.Day=e}(TheDatepicker||(TheDatepicker={})),function(t){var e;!function(t){t[t.Monday=1]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday",t[t.Sunday=0]="Sunday"}(t.DayOfWeek||(t.DayOfWeek={})),function(t){t[t.January=0]="January",t[t.February=1]="February",t[t.March=2]="March",t[t.April=3]="April",t[t.May=4]="May",t[t.June=5]="June",t[t.July=6]="July",t[t.August=7]="August",t[t.September=8]="September",t[t.October=9]="October",t[t.November=10]="November",t[t.December=11]="December"}(t.Month||(t.Month={})),function(t){t[t.Enter=13]="Enter",t[t.Space=32]="Space",t[t.Left=37]="Left",t[t.Up=38]="Up",t[t.Right=39]="Right",t[t.Down=40]="Down"}(t.KeyCode_||(t.KeyCode_={})),function(t){t.MouseDown="mousedown",t.Focus="focus",t.FocusIn="focusin",t.Blur="blur",t.KeyDown="keydown",t.KeyUp="keyup",t.TouchStart="touchstart",t.TouchMove="touchmove",t.AnimationEnd="animationend"}(e=t.ListenerType_||(t.ListenerType_={}));var n=function(){function n(){}return n.resetTime_=function(t){return t?(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t):null},n.normalizeDate_=function(e,i,o,r){if(!i){if(!o)throw new Error(e+" cannot be empty.");return null}if(i instanceof t.Day)return i.getDate();if("string"==typeof i){if("today"===i||"now"===i)return r.getToday();if("tomorrow"===i){var s=r.getToday();return s.setDate(s.getDate()+1),s}if("yesterday"===i){var a=r.getToday();return a.setDate(a.getDate()-1),a}var l=i.match(/^\s*([+-]?)\s*([0-9]+)\s*(day|month|year)s?\s*$/i);if(l){var h=r.getToday(),p=parseInt(l[2],10)*("-"===l[1]?-1:1);switch(l[3].toLowerCase()){case"day":case"days":h.setDate(h.getDate()+p);break;case"month":case"months":h.setMonth(h.getMonth()+p);break;case"year":case"years":h.setFullYear(h.getFullYear()+p)}return h}var u=n.resetTime_(new Date(i));if(!isNaN(u.getTime()))return u}else if(n.isValidDate_(i)){u=n.resetTime_(new Date(i.getTime()));if(!isNaN(u.getTime()))return u}throw new Error(e+" was expected to be a valid Date string or valid Date or Day"+(o?" or null.":"."))},n.isElement_=function(t){return"object"==typeof t&&1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument},n.isValidDate_=function(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())},n.inArray_=function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1},n.addEventListener_=function(t,e,i,o){if(void 0===o&&(o=!1),t.addEventListener){var r=void 0;return o&&n.isPassiveEventListenerSupported_()&&(r={passive:!0}),t.addEventListener(e,i,r),function(){t.removeEventListener(e,i)}}var s="on"+e,a=t[s]||null;return t[s]=function(e){e=e||window.event,a&&a.call(t,e),i(e)},function(){t[s]=a}},n.preventDefault_=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},n.stopPropagation_=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},n.checkString_=function(t,e,n){if(void 0===n&&(n=!1),!n&&!e)return"";if("string"!=typeof e||n&&""===e)throw new Error(t+" was expected to be a"+(n?" non empty":"")+" string.");return e},n.checkNumber_=function(t,e,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),"number"!=typeof(e="string"==typeof e?parseInt(e):e)||isNaN(e)||null!==n&&e<n||null!==i&&e>i)throw new Error(t+" was expected to be a valid number"+(null!==n?" from "+n:"")+(null!==i?" to "+i:"")+".");return e},n.checkFunction_=function(t,e,n){if(void 0===n&&(n=!0),n&&!e)return null;if("function"!=typeof e)throw new Error(t+" was expected to be a function"+(n?" or null":"")+".");return e},n.warnDeprecatedUsage_=function(t,e){if(window.console){for(var i=0;i<n.deprecatedMethods_.length;i++)if(t===n.deprecatedMethods_[0])return;window.console.warn("TheDatepicker: "+t+"() is deprecated, use "+e+"()"),n.deprecatedMethods_.push(t)}},n.addSwipeListener_=function(t,i){var o=null,r=null;n.addEventListener_(t,e.TouchStart,(function(e){o=e.touches[0].clientX,r=t.offsetWidth/5}),!0),n.addEventListener_(t,e.TouchMove,(function(t){if(null!==o){var e=t.touches[0].clientX-o;Math.abs(e)>r&&(i(t,e>0),o=null)}}),!0)},n.isCssAnimationSupported_=function(){if(null===n.cssAnimationSupport_){var t=document.createElement("div");n.cssAnimationSupport_=""===t.style.animationName}return n.cssAnimationSupport_},n.isPassiveEventListenerSupported_=function(){if(null===n.passiveEventListenerSupport_){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){return t=!0,!1}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}n.passiveEventListenerSupport_=t}return n.passiveEventListenerSupport_},n.deprecatedMethods_=[],n.cssAnimationSupport_=null,n.passiveEventListenerSupport_=null,n}();t.Helper_=n}(TheDatepicker||(TheDatepicker={})),function(t){var e=function(){function e(t){this.options_=t,this.document_=document}return e.prototype.createDiv_=function(t){var e=this.document_.createElement("div");return this.addClass_(e,t),e},e.prototype.createAnchor_=function(e){var n=this.document_.createElement("a");return this.addClass_(n,"button"),n.href="#",n.onclick=function(n){n=n||window.event,t.Helper_.preventDefault_(n),e(n)},n.onkeydown=function(n){n=n||window.event,t.Helper_.inArray_([t.KeyCode_.Enter,t.KeyCode_.Space],n.keyCode)&&(t.Helper_.preventDefault_(n),e(n))},n},e.prototype.createSpan_=function(){return this.document_.createElement("span")},e.prototype.createTable_=function(t,e,n){var i=this.document_.createElement("table");return this.addClass_(i,t),i.appendChild(e),i.appendChild(n),i},e.prototype.createTableHeader_=function(t,e){var n=this.document_.createElement("thead");this.addClass_(n,t);for(var i=this.document_.createElement("tr"),o=0;o<e.length;o++)i.appendChild(e[o]);return n.appendChild(i),n},e.prototype.createTableHeaderCell_=function(t){var e=this.document_.createElement("th");return e.scope="col",this.addClass_(e,t),e},e.prototype.createTableBody_=function(t,e){var n=this.document_.createElement("tbody");this.addClass_(n,t);for(var i=0;i<e.length;i++)n.appendChild(e[i]);return n},e.prototype.createTableRow_=function(t,e){for(var n=this.document_.createElement("tr"),i=0;i<e.length;i++)n.appendChild(e[i]);return n},e.prototype.createTableCell_=function(){return this.document_.createElement("td")},e.prototype.createSelectInput_=function(e,n){var i=this.document_.createElement("select");this.addClass_(i,"select");for(var o=0;o<e.length;o++)i.appendChild(this.createSelectOption_(e[o].value,e[o].label));return i.onchange=function(t){n(t||window.event,i.value)},i.onkeydown=function(e){e=e||window.event,t.Helper_.stopPropagation_(e)},i},e.prototype.createSelectOption_=function(t,e){var n=this.document_.createElement("option");return n.value=t,n.innerText=e,n},e.prototype.addClass_=function(t,e){e=this.options_.prefixClass_(e),""!==t.className&&(e=" "+e),t.className+=e},e.prototype.appendChild_=function(t,e){e&&t.appendChild(e)},e}();t.HtmlHelper_=e}(TheDatepicker||(TheDatepicker={})),function(t){var e;!function(t){t.BeforeSelect="beforeSelect",t.Select="select",t.BeforeOpenAndClose="beforeOpenAndClose",t.OpenAndClose="openAndClose",t.BeforeMonthChange="beforeMonthChange",t.MonthChange="monthChange",t.Focus="focus",t.BeforeFocus="beforeFocus"}(e=t.EventType_||(t.EventType_={}));var n=function(){};t.AvailableDateNotFoundException=n;var i=function(){function i(e){void 0===e&&(e=null),this.hideOnBlur_=!0,this.hideOnSelect_=!0,this.minDate_=null,this.maxDate_=null,this.initialDate_=null,this.initialMonth_=null,this.initialDatePriority_=!0,this.firstDayOfWeek_=t.DayOfWeek.Monday,this.dateAvailabilityResolver_=null,this.cellContentResolver_=null,this.cellContentStructureResolver_=null,this.headerStructureResolver_=null,this.footerStructureResolver_=null,this.cellClassesResolvers_=[],this.dayModifiers_=[],this.inputFormat_="j. n. Y",this.daysOutOfMonthVisible_=!1,this.fixedRowsCount_=!1,this.toggleSelection_=!1,this.allowEmpty_=!0,this.showDeselectButton_=!0,this.showResetButton_=!1,this.monthAsDropdown_=!0,this.yearAsDropdown_=!0,this.monthAndYearSeparated_=!0,this.monthShort_=!1,this.changeMonthOnSwipe_=!0,this.animateMonthChange_=!0,this.classesPrefix_="the-datepicker__",this.showCloseButton_=!0,this.title_="",this.dropdownItemsLimit_=200,this.hideDropdownWithOneItem_=!0,this.goBackHtml_="&lt;",this.goForwardHtml_="&gt;",this.closeHtml_="&times;",this.resetHtml_="&olarr;",this.deselectHtml_="&times;",this.positionFixing_=!0,this.today_=null,this.listeners_={beforeSelect:[],select:[],beforeOpenAndClose:[],openAndClose:[],beforeMonthChange:[],monthChange:[],beforeFocus:[],focus:[]},this.translator=e||new t.Translator,this.document_=document}return i.prototype.clone=function(){var t=new i(this.translator);return t.hideOnBlur_=this.hideOnBlur_,t.hideOnSelect_=this.hideOnSelect_,t.minDate_=this.minDate_,t.maxDate_=this.maxDate_,t.initialDate_=this.initialDate_,t.initialMonth_=this.initialMonth_,t.initialDatePriority_=this.initialDatePriority_,t.firstDayOfWeek_=this.firstDayOfWeek_,t.dateAvailabilityResolver_=this.dateAvailabilityResolver_,t.cellContentResolver_=this.cellContentResolver_,t.cellContentStructureResolver_=this.cellContentStructureResolver_,t.headerStructureResolver_=this.headerStructureResolver_,t.footerStructureResolver_=this.footerStructureResolver_,t.cellClassesResolvers_=this.cellClassesResolvers_.slice(0),t.dayModifiers_=this.dayModifiers_.slice(0),t.inputFormat_=this.inputFormat_,t.daysOutOfMonthVisible_=this.daysOutOfMonthVisible_,t.fixedRowsCount_=this.fixedRowsCount_,t.toggleSelection_=this.toggleSelection_,t.allowEmpty_=this.allowEmpty_,t.showDeselectButton_=this.showDeselectButton_,t.showResetButton_=this.showResetButton_,t.monthAsDropdown_=this.monthAsDropdown_,t.yearAsDropdown_=this.yearAsDropdown_,t.monthAndYearSeparated_=this.monthAndYearSeparated_,t.monthShort_=this.monthShort_,t.changeMonthOnSwipe_=this.changeMonthOnSwipe_,t.animateMonthChange_=this.animateMonthChange_,t.classesPrefix_=this.classesPrefix_,t.showCloseButton_=this.showCloseButton_,t.title_=this.title_,t.dropdownItemsLimit_=this.dropdownItemsLimit_,t.hideDropdownWithOneItem_=this.hideDropdownWithOneItem_,t.goBackHtml_=this.goBackHtml_,t.goForwardHtml_=this.goForwardHtml_,t.closeHtml_=this.closeHtml_,t.resetHtml_=this.resetHtml_,t.deselectHtml_=this.deselectHtml_,t.positionFixing_=this.positionFixing_,t.listeners_.beforeSelect=this.listeners_.beforeSelect.slice(0),t.listeners_.select=this.listeners_.select.slice(0),t.listeners_.beforeOpenAndClose=this.listeners_.beforeOpenAndClose.slice(0),t.listeners_.openAndClose=this.listeners_.openAndClose.slice(0),t.listeners_.beforeMonthChange=this.listeners_.beforeMonthChange.slice(0),t.listeners_.monthChange=this.listeners_.monthChange.slice(0),t.listeners_.beforeFocus=this.listeners_.beforeFocus.slice(0),t.listeners_.focus=this.listeners_.focus.slice(0),t},i.prototype.setHideOnBlur=function(t){this.hideOnBlur_=!!t},i.prototype.setHideOnSelect=function(t){this.hideOnSelect_=!!t},i.prototype.setMinDate=function(e){var n=t.Helper_.normalizeDate_("Min date",e,!0,this);this.checkConstraints_(n,this.maxDate_),this.minDate_=n},i.prototype.setMaxDate=function(e){var n=t.Helper_.normalizeDate_("Max date",e,!0,this);this.checkConstraints_(this.minDate_,n),this.maxDate_=n},i.prototype.setInitialMonth=function(e){this.initialMonth_=t.Helper_.normalizeDate_("Initial month",e,!0,this)},i.prototype.setInitialDate=function(e){this.initialDate_=t.Helper_.normalizeDate_("Initial date",e,!0,this)},i.prototype.setInitialDatePriority=function(t){this.initialDatePriority_=!!t},i.prototype.setFirstDayOfWeek=function(e){this.firstDayOfWeek_=t.Helper_.checkNumber_("First day of week",e,0,6)},i.prototype.setDateAvailabilityResolver=function(e){this.dateAvailabilityResolver_=t.Helper_.checkFunction_("Resolver",e)},i.prototype.setCellContentResolver=function(e){this.cellContentResolver_=t.Helper_.checkFunction_("Resolver",e)},i.prototype.setCellContentStructureResolver=function(e,n){void 0===n&&(n=null),e=t.Helper_.checkFunction_("Resolver (init)",e),n=t.Helper_.checkFunction_("Resolver (update)",n),this.cellContentStructureResolver_=e?{init:e,update:n}:null},i.prototype.setHeaderStructureResolver=function(e){this.headerStructureResolver_=t.Helper_.checkFunction_("Resolver",e)},i.prototype.setFooterStructureResolver=function(e){this.footerStructureResolver_=t.Helper_.checkFunction_("Resolver",e)},i.prototype.addCellClassesResolver=function(e){this.cellClassesResolvers_.push(t.Helper_.checkFunction_("Resolver",e,!1))},i.prototype.removeCellClassesResolver=function(e){if(void 0===e&&(e=null),e=t.Helper_.checkFunction_("Resolver",e)){for(var n=[],i=0;i<this.cellClassesResolvers_.length;i++)this.cellClassesResolvers_[i]!==e&&n.push(this.cellClassesResolvers_[i]);this.cellClassesResolvers_=n}else this.cellClassesResolvers_=[]},i.prototype.addDayModifier=function(e){this.dayModifiers_.push(t.Helper_.checkFunction_("Modifier",e,!1))},i.prototype.removeDayModifier=function(e){if(void 0===e&&(e=null),e=t.Helper_.checkFunction_("Modifier",e)){for(var n=[],i=0;i<this.dayModifiers_.length;i++)this.dayModifiers_[i]!==e&&n.push(this.dayModifiers_[i]);this.dayModifiers_=n}else this.dayModifiers_=[]},i.prototype.setInputFormat=function(e){this.inputFormat_=t.Helper_.checkString_("Input format",e,!0)},i.prototype.setDaysOutOfMonthVisible=function(t){this.daysOutOfMonthVisible_=!!t},i.prototype.setFixedRowsCount=function(t){this.fixedRowsCount_=!!t},i.prototype.setToggleSelection=function(t){this.toggleSelection_=!!t},i.prototype.setShowDeselectButton=function(t){this.showDeselectButton_=!!t},i.prototype.setAllowEmpty=function(t){this.allowEmpty_=!!t},i.prototype.setShowResetButton=function(t){this.showResetButton_=!!t},i.prototype.setMonthAsDropdown=function(t){this.monthAsDropdown_=!!t},i.prototype.setYearAsDropdown=function(t){this.yearAsDropdown_=!!t},i.prototype.setMonthAndYearSeparated=function(t){this.monthAndYearSeparated_=!!t},i.prototype.setMonthShort=function(t){this.monthShort_=!!t},i.prototype.setChangeMonthOnSwipe=function(t){this.changeMonthOnSwipe_=!!t},i.prototype.setAnimateMonthChange=function(t){this.animateMonthChange_=!!t},i.prototype.setClassesPrefix=function(e){this.classesPrefix_=t.Helper_.checkString_("Prefix",e)},i.prototype.setShowCloseButton=function(t){this.showCloseButton_=!!t},i.prototype.setTitle=function(e){this.title_=t.Helper_.checkString_("Title",e)},i.prototype.setDropdownItemsLimit=function(e){this.dropdownItemsLimit_=t.Helper_.checkNumber_("Items limit",e,1)},i.prototype.setHideDropdownWithOneItem=function(t){this.hideDropdownWithOneItem_=!!t},i.prototype.setGoBackHtml=function(e){this.goBackHtml_=t.Helper_.checkString_("Html",e)},i.prototype.setGoForwardHtml=function(e){this.goForwardHtml_=t.Helper_.checkString_("Html",e)},i.prototype.setCloseHtml=function(e){this.closeHtml_=t.Helper_.checkString_("Html",e)},i.prototype.setResetHtml=function(e){this.resetHtml_=t.Helper_.checkString_("Html",e)},i.prototype.setDeselectHtml=function(e){this.deselectHtml_=t.Helper_.checkString_("Html",e)},i.prototype.setPositionFixing=function(t){this.positionFixing_=!!t},i.prototype.setToday=function(e){this.today_=t.Helper_.normalizeDate_("Today",e,!0,this)},i.prototype.onBeforeSelect=function(t){this.onEvent_(e.BeforeSelect,t)},i.prototype.offBeforeSelect=function(t){void 0===t&&(t=null),this.offEvent_(e.BeforeSelect,t)},i.prototype.onSelect=function(t){this.onEvent_(e.Select,t)},i.prototype.offSelect=function(t){void 0===t&&(t=null),this.offEvent_(e.Select,t)},i.prototype.onBeforeOpenAndClose=function(t){this.onEvent_(e.BeforeOpenAndClose,t)},i.prototype.offBeforeOpenAndClose=function(t){void 0===t&&(t=null),this.offEvent_(e.BeforeOpenAndClose,t)},i.prototype.onOpenAndClose=function(t){this.onEvent_(e.OpenAndClose,t)},i.prototype.offOpenAndClose=function(t){void 0===t&&(t=null),this.offEvent_(e.OpenAndClose,t)},i.prototype.onBeforeMonthChange=function(t){this.onEvent_(e.BeforeMonthChange,t)},i.prototype.offBeforeMonthChange=function(t){void 0===t&&(t=null),this.offEvent_(e.BeforeMonthChange,t)},i.prototype.onMonthChange=function(t){this.onEvent_(e.MonthChange,t)},i.prototype.offMonthChange=function(t){void 0===t&&(t=null),this.offEvent_(e.MonthChange,t)},i.prototype.onBeforeFocus=function(t){this.onEvent_(e.BeforeFocus,t)},i.prototype.offBeforeFocus=function(t){void 0===t&&(t=null),this.offEvent_(e.BeforeFocus,t)},i.prototype.onFocus=function(t){this.onEvent_(e.Focus,t)},i.prototype.offFocus=function(t){void 0===t&&(t=null),this.offEvent_(e.Focus,t)},i.prototype.getInitialMonth=function(){var t=this.initialDatePriority_?this.initialDate_:this.initialMonth_,e=this.initialDatePriority_?this.initialMonth_:this.initialDate_,n=t?new Date(t.getTime()):e?new Date(e.getTime()):this.getToday();return n.setDate(1),this.correctMonth(n)},i.prototype.isMonthInValidity=function(t){return!this.calculateMonthCorrection_(t)},i.prototype.correctMonth=function(t){return this.calculateMonthCorrection_(t)||t},i.prototype.getInitialDate=function(){return this.findPossibleAvailableDate(this.initialDate_)},i.prototype.findPossibleAvailableDate=function(t){if(this.isAllowedEmpty())return t&&this.isDateInValidity(t)&&this.isDateAvailable(t)?new Date(t.getTime()):null;if(t=t?new Date(t.getTime()):this.getToday(),t=this.findNearestAvailableDate(t))return t;throw new n},i.prototype.findNearestAvailableDate=function(t){if(t=this.correctDate_(t),this.isDateAvailable(t))return t;var e=this.getMinDate_().getTime(),n=this.getMaxDate_().getTime(),i=1e3,o=t,r=new Date(t.getTime());do{if(o)if(o.setDate(o.getDate()+1),o.getTime()>n)o=null;else if(this.isDateAvailable(o))return o;if(r)if(r.setDate(r.getDate()-1),r.getTime()<e)r=null;else if(this.isDateAvailable(r))return r;i--}while((o||r)&&i>0);return null},i.prototype.isDateInValidity=function(t){return!this.calculateDateCorrection_(t)},i.prototype.correctDate_=function(t){return this.calculateDateCorrection_(t)||t},i.prototype.getFirstDayOfWeek=function(){return this.firstDayOfWeek_},i.prototype.areDaysOutOfMonthVisible=function(){return this.daysOutOfMonthVisible_},i.prototype.hasFixedRowsCount=function(){return this.fixedRowsCount_},i.prototype.hasToggleSelection=function(){return this.allowEmpty_&&this.toggleSelection_},i.prototype.isAllowedEmpty=function(){return this.allowEmpty_},i.prototype.isDeselectButtonShown=function(){return this.allowEmpty_&&this.showDeselectButton_},i.prototype.isResetButtonShown=function(){return this.showResetButton_},i.prototype.isMonthAsDropdown=function(){return this.monthAsDropdown_},i.prototype.isYearAsDropdown=function(){return this.yearAsDropdown_},i.prototype.isMonthAndYearSeparated=function(){return this.monthAndYearSeparated_},i.prototype.isMonthShort=function(){return this.monthShort_},i.prototype.isMonthChangeOnSwipeEnabled_=function(){return this.changeMonthOnSwipe_},i.prototype.isMonthChangeAnimated=function(){return this.animateMonthChange_},i.prototype.getClassesPrefix=function(){return this.classesPrefix_},i.prototype.isCloseButtonShown=function(){return this.hideOnBlur_&&this.showCloseButton_},i.prototype.getTitle=function(){return this.title_},i.prototype.getMinDate=function(){return this.minDate_?new Date(this.minDate_.getTime()):null},i.prototype.getMaxDate=function(){return this.maxDate_?new Date(this.maxDate_.getTime()):null},i.prototype.getMinDate_=function(){var t=this.getMinDate();return t||new Date(-271821,4,1)},i.prototype.getMaxDate_=function(){var t=this.getMaxDate();return t||new Date(275760,7,31)},i.prototype.getMinMonth=function(){if(!this.minDate_)return null;var t=new Date(this.minDate_.getTime());return t.setDate(1),t},i.prototype.getMaxMonth=function(){if(!this.maxDate_)return null;var t=new Date(this.maxDate_.getTime());return t.setDate(1),t},i.prototype.getMinMonth_=function(){var t=this.getMinMonth();return t||(t=this.getMinDate_()),t},i.prototype.getMaxMonth_=function(){var t=this.getMaxMonth();return t||(t=this.getMaxDate_()).setDate(1),t},i.prototype.isDropdownWithOneItemHidden=function(){return this.hideDropdownWithOneItem_},i.prototype.getDropdownItemsLimit=function(){return this.dropdownItemsLimit_},i.prototype.isDateAvailable=function(t){return!this.dateAvailabilityResolver_||!!this.dateAvailabilityResolver_(new Date(t.getTime()))},i.prototype.getCellContent=function(t){return this.cellContentResolver_?this.cellContentResolver_(t):t.dayNumber+""},i.prototype.prefixClass_=function(t){return this.classesPrefix_+t},i.prototype.getCellStructure_=function(){return this.cellContentStructureResolver_?this.cellContentStructureResolver_.init():this.document_.createElement("span")},i.prototype.updateCellStructure_=function(t,e){this.cellContentStructureResolver_?this.cellContentStructureResolver_.update(t,e):t.innerText=this.getCellContent(e)},i.prototype.getHeaderStructure_=function(){return this.headerStructureResolver_?this.headerStructureResolver_():null},i.prototype.getFooterStructure_=function(){return this.footerStructureResolver_?this.footerStructureResolver_():null},i.prototype.getCellClasses=function(t){for(var e=[],n=this.cellClassesResolvers_.slice(0),i=0;i<n.length;i++){var o=n[i](t);"string"==typeof o?e.push(o):"object"==typeof o&&o.constructor===Array&&(e=e.concat(o))}return e},i.prototype.modifyDay=function(t){for(var e=this.dayModifiers_.slice(0),n=0;n<e.length;n++)e[n](t)},i.prototype.getGoBackHtml=function(){return this.goBackHtml_},i.prototype.getGoForwardHtml=function(){return this.goForwardHtml_},i.prototype.getCloseHtml=function(){return this.closeHtml_},i.prototype.getResetHtml=function(){return this.resetHtml_},i.prototype.getDeselectHtml=function(){return this.deselectHtml_},i.prototype.isHiddenOnBlur=function(){return this.hideOnBlur_},i.prototype.isHiddenOnSelect=function(){return this.hideOnBlur_&&this.hideOnSelect_},i.prototype.getInputFormat=function(){return this.inputFormat_},i.prototype.isPositionFixingEnabled=function(){return this.hideOnBlur_&&this.positionFixing_},i.prototype.getToday=function(){return this.today_?new Date(this.today_.getTime()):t.Helper_.resetTime_(new Date)},i.prototype.getDateAvailabilityResolver=function(){return this.dateAvailabilityResolver_},i.prototype.getCellContentResolver=function(){return this.cellContentResolver_},i.prototype.getCellContentStructureResolver=function(){return this.cellContentStructureResolver_},i.prototype.getHeaderStructureResolver=function(){return this.headerStructureResolver_},i.prototype.getFooterStructureResolver=function(){return this.footerStructureResolver_},i.prototype.getCellClassesResolvers=function(){return this.cellClassesResolvers_},i.prototype.getDayModifiers=function(){return this.dayModifiers_},i.prototype.getBeforeSelectListeners=function(){return this.listeners_.beforeSelect},i.prototype.getSelectListeners=function(){return this.listeners_.select},i.prototype.getBeforeOpenAndCloseListeners=function(){return this.listeners_.beforeOpenAndClose},i.prototype.getOpenAndCloseListeners=function(){return this.listeners_.openAndClose},i.prototype.getBeforeMonthChangeListeners=function(){return this.listeners_.beforeMonthChange},i.prototype.getMonthChangeListeners=function(){return this.listeners_.monthChange},i.prototype.getBeforeFocusListeners=function(){return this.listeners_.beforeFocus},i.prototype.getFocusListeners=function(){return this.listeners_.focus},i.prototype.checkConstraints_=function(t,e){if(t&&e&&t.getTime()>e.getTime())throw new Error("Min date cannot be higher then max date.")},i.prototype.calculateMonthCorrection_=function(t){var e=this.getMinMonth_();if(t.getTime()<e.getTime())return e;var n=this.getMaxMonth_();return t.getTime()>n.getTime()?n:null},i.prototype.calculateDateCorrection_=function(t){var e=this.getMinDate_();if(t.getTime()<e.getTime())return e;var n=this.getMaxDate_();return t.getTime()>n.getTime()?n:null},i.prototype.onEvent_=function(e,n){this.listeners_[e].push(t.Helper_.checkFunction_("Event listener",n,!1))},i.prototype.offEvent_=function(e,n){if(n=t.Helper_.checkFunction_("Event listener",n)){for(var i=[],o=0;o<this.listeners_[e].length;o++)this.listeners_[e][o]!==n&&i.push(this.listeners_[e][o]);this.listeners_[e]=i}else this.listeners_[e]=[]},i.prototype.triggerEvent_=function(t,e){for(var n=this.listeners_[t].slice(0),i=0;i<n.length;i++)if(!1===e(n[i]))return!1;return!0},i}();t.Options=i}(TheDatepicker||(TheDatepicker={})),function(t){var e=function(){function e(t,e,n,i){this.options_=t,this.htmlHelper_=e,this.container_=n,this.hasInput_=i,this.mainElement_=null,this.bodyElement_=null,this.controlElement_=null,this.goBackElement_=null,this.goForwardElement_=null,this.titleElement_=null,this.titleContentElement_=null,this.resetElement_=null,this.closeElement_=null,this.monthSelect_=null,this.monthElement_=null,this.yearSelect_=null,this.yearElement_=null,this.monthAndYearSelect_=null,this.monthAndYearElement_=null,this.weeksElements_=[],this.daysElements_=[],this.daysButtonsElements_=[],this.daysContentsElements_=[]}return e.prototype.render_=function(t){if(!this.mainElement_){if(this.hasInput_&&this.options_.isHiddenOnBlur()&&!t.isActive_())return;this.container_.innerHTML="",this.container_.appendChild(this.createSkeleton_(t))}this.updateMainElement_(t),this.updateTopElement_(t),this.updateTitleElement_(t),this.updateCloseElement_(t),this.updateResetElement_(t),this.updateGoBackElement_(t),this.updateGoForwardElement_(t),this.updateMonthElement_(t),this.updateYearElement_(t),this.updateMonthAndYearElement_(t),this.updateWeeksElements_(t)},e.prototype.createSkeleton_=function(t){var e=this.htmlHelper_.createDiv_("main");return this.htmlHelper_.appendChild_(e,this.options_.getHeaderStructure_()),e.appendChild(this.createHeaderElement_(t)),e.appendChild(this.createBodyElement_(t)),this.htmlHelper_.appendChild_(e,this.options_.getFooterStructure_()),this.mainElement_=e,e},e.prototype.updateMainElement_=function(t){this.mainElement_.style.display=this.hasInput_&&!t.isActive_()&&this.options_.isHiddenOnBlur()?"none":""},e.prototype.createBodyElement_=function(e){var n=this,i=this.htmlHelper_.createDiv_("body");return this.options_.isMonthChangeOnSwipeEnabled_()&&t.Helper_.addSwipeListener_(i,(function(t,i){n.slideMonth_(e,t,!i)})),i.appendChild(this.createTableElement_(e)),this.bodyElement_=i,i},e.prototype.createHeaderElement_=function(t){var e=this.htmlHelper_.createDiv_("header"),n=this.htmlHelper_.createDiv_("top");e.appendChild(n),n.appendChild(this.createTitleElement_(t));var i=this.htmlHelper_.createDiv_("control");n.appendChild(i),i.appendChild(this.createResetElement_(t)),i.appendChild(this.createCloseElement_(t));var o=this.htmlHelper_.createDiv_("navigation");e.appendChild(o),o.appendChild(this.createGoBackElement_(t));var r=this.htmlHelper_.createDiv_("state");return o.appendChild(r),this.options_.isMonthAndYearSeparated()?(r.appendChild(this.createMonthElement_(t)),r.appendChild(this.createYearElement_(t))):r.appendChild(this.createMonthAndYearElement_(t)),o.appendChild(this.createGoForwardElement_(t)),this.controlElement_=i,e},e.prototype.updateTopElement_=function(t){var e=""!==this.options_.getTitle()||this.options_.isResetButtonShown()||this.hasInput_&&this.options_.isCloseButtonShown();this.controlElement_.style.display=e?"":"none",this.titleElement_.style.display=e?"":"none"},e.prototype.createTitleElement_=function(t){var e=this.htmlHelper_.createDiv_("title"),n=this.htmlHelper_.createSpan_();return e.appendChild(n),this.htmlHelper_.addClass_(n,"title-content"),this.titleElement_=e,this.titleContentElement_=n,e},e.prototype.updateTitleElement_=function(t){var e=this.options_.getTitle();this.titleContentElement_.style.display=""!==e?"":"none",this.titleContentElement_.innerText=e},e.prototype.createResetElement_=function(e){var n=this.htmlHelper_.createDiv_("reset"),i=this.htmlHelper_.createAnchor_((function(t){e.reset_(t)}));i.innerHTML=this.options_.getResetHtml();var o=this.options_.translator.translateTitle(t.TitleName.Reset);return""!==o&&(i.title=o),n.appendChild(i),this.resetElement_=n,n},e.prototype.updateResetElement_=function(t){this.resetElement_.style.display=this.options_.isResetButtonShown()?"":"none"},e.prototype.createCloseElement_=function(e){var n=this.htmlHelper_.createDiv_("close"),i=this.htmlHelper_.createAnchor_((function(t){e.close_(t)}));i.innerHTML=this.options_.getCloseHtml();var o=this.options_.translator.translateTitle(t.TitleName.Close);return""!==o&&(i.title=o),n.appendChild(i),this.closeElement_=n,n},e.prototype.updateCloseElement_=function(t){this.closeElement_.style.display=this.hasInput_&&this.options_.isCloseButtonShown()?"":"none"},e.prototype.createGoBackElement_=function(t){return this.createGoElement_(t,!1)},e.prototype.createGoForwardElement_=function(t){return this.createGoElement_(t,!0)},e.prototype.createGoElement_=function(e,n){var i=this,o=this.htmlHelper_.createDiv_("go");this.htmlHelper_.addClass_(o,n?"go-next":"go-previous");var r=this.htmlHelper_.createAnchor_((function(t){i.slideMonth_(e,t,n)}));r.innerHTML=n?this.options_.getGoForwardHtml():this.options_.getGoBackHtml();var s=this.options_.translator.translateTitle(n?t.TitleName.GoForward:t.TitleName.GoBack);return""!==s&&(r.title=s),o.appendChild(r),n?this.goForwardElement_=r:this.goBackElement_=r,o},e.prototype.updateGoBackElement_=function(t){this.goBackElement_.style.visibility=t.canGoBack_()?"visible":"hidden"},e.prototype.updateGoForwardElement_=function(t){this.goForwardElement_.style.visibility=t.canGoForward_()?"visible":"hidden"},e.prototype.createMonthElement_=function(t){for(var e=this,n=[],i=0;i<12;i++)n.push({value:i+"",label:this.translateMonth(i)});var o=this.htmlHelper_.createSelectInput_(n,(function(n,i){var o=t.getCurrentMonth_(),r=new Date(o.getTime());r.setMonth(parseInt(i,10)),t.goToMonth_(n,r)||(e.monthSelect_.value=o.getMonth()+"")})),r=this.htmlHelper_.createDiv_("month"),s=this.htmlHelper_.createSpan_();return r.appendChild(o),r.appendChild(s),this.monthElement_=s,this.monthSelect_=o,r},e.prototype.updateMonthElement_=function(t){if(this.monthElement_){var e=t.getCurrentMonth_().getMonth();if(this.monthElement_.innerText=this.translateMonth(e),!this.options_.isMonthAsDropdown())return this.monthSelect_.style.display="none",void(this.monthElement_.style.display="");for(var n=0,i=0;i<12;i++){var o=new Date(t.getCurrentMonth_().getTime());o.setMonth(i);var r=this.monthSelect_.getElementsByTagName("option")[i],s=t.canGoToMonth_(o);r.disabled=!s,r.style.display=s?"":"none",n+=s?1:0}this.monthSelect_.value=e+"";var a=!this.options_.isDropdownWithOneItemHidden()||n>1;this.monthSelect_.style.display=a?"":"none",this.monthElement_.style.display=a?"none":""}},e.prototype.createYearElement_=function(t){var e=this,n=this.htmlHelper_.createSelectInput_([],(function(n,i){var o=t.getCurrentMonth_(),r=new Date(o.getTime());r.setFullYear(parseInt(i,10));var s=e.options_.getMinMonth_(),a=e.options_.getMaxMonth_();r.getTime()<s.getTime()&&(r=s),r.getTime()>a.getTime()&&(r=a),t.goToMonth_(n,r)||(e.yearSelect_.value=o.getFullYear()+"")})),i=this.htmlHelper_.createDiv_("year"),o=this.htmlHelper_.createSpan_();return i.appendChild(n),i.appendChild(o),this.yearElement_=o,this.yearSelect_=n,i},e.prototype.updateYearElement_=function(t){if(this.yearElement_){var e=t.getCurrentMonth_().getFullYear();if(this.yearElement_.innerText=e+"",!this.options_.isYearAsDropdown())return this.yearSelect_.style.display="none",void(this.yearElement_.style.display="");for(var n=this.options_.getMinDate_().getFullYear(),i=this.options_.getMaxDate_().getFullYear(),o=this.calculateDropdownRange_(e,n,i),r=this.yearSelect_.getElementsByTagName("option"),s=this.calculateDropdownDiff_(r,o,(function(t){return parseInt(t,10)})),a=0;a<s.remove.length;a++)this.yearSelect_.removeChild(s.remove[a]);for(a=s.prepend.length-1;a>=0;a--)this.yearSelect_.insertBefore(this.htmlHelper_.createSelectOption_(s.prepend[a]+"",s.prepend[a]+""),this.yearSelect_.firstChild);for(a=0;a<s.append.length;a++)this.yearSelect_.appendChild(this.htmlHelper_.createSelectOption_(s.append[a]+"",s.append[a]+""));this.yearSelect_.value=e+"";var l=!this.options_.isDropdownWithOneItemHidden()||o.from<o.to;this.yearSelect_.style.display=l?"":"none",this.yearElement_.style.display=l?"none":""}},e.prototype.createMonthAndYearElement_=function(t){var e=this,n=this.htmlHelper_.createDiv_("month-year"),i=this.htmlHelper_.createSelectInput_([],(function(n,i){var o=t.getCurrentMonth_(),r=new Date(o.getTime()),s=e.parseMonthAndYearOptionValue_(i);r.setFullYear(s.year),r.setMonth(s.month),t.goToMonth_(n,r)||(e.monthAndYearSelect_.value=e.getMonthAndYearOptionValue_({month:o.getMonth(),year:o.getFullYear()}))})),o=this.htmlHelper_.createSpan_();return this.monthAndYearElement_=o,this.monthAndYearSelect_=i,n.appendChild(o),n.appendChild(i),n},e.prototype.updateMonthAndYearElement_=function(t){var e=this;if(this.monthAndYearElement_){var n=t.getCurrentMonth_(),i={month:n.getMonth(),year:n.getFullYear()},o=this.calculateMonthAndYearIndex_(i);if(this.monthAndYearElement_.innerText=this.translateMonthAndYear_(i),!this.options_.isYearAsDropdown()||!this.options_.isMonthAsDropdown())return this.monthAndYearSelect_.style.display="none",void(this.monthAndYearElement_.style.display="");for(var r=this.options_.getMinDate_(),s=this.options_.getMaxDate_(),a=12*r.getFullYear()+r.getMonth(),l=12*s.getFullYear()+s.getMonth(),h=this.calculateDropdownRange_(o,a,l),p=this.monthAndYearSelect_.getElementsByTagName("option"),u=this.calculateDropdownDiff_(p,h,(function(t){return e.calculateMonthAndYearIndex_(e.parseMonthAndYearOptionValue_(t))})),_=0;_<u.remove.length;_++)this.monthAndYearSelect_.removeChild(u.remove[_]);for(_=u.prepend.length-1;_>=0;_--){var c=this.getMonthAndYearByIndex_(u.prepend[_]);this.monthAndYearSelect_.insertBefore(this.htmlHelper_.createSelectOption_(this.getMonthAndYearOptionValue_(c),this.translateMonthAndYear_(c)),this.monthAndYearSelect_.firstChild)}for(_=0;_<u.append.length;_++){c=this.getMonthAndYearByIndex_(u.append[_]);this.monthAndYearSelect_.appendChild(this.htmlHelper_.createSelectOption_(this.getMonthAndYearOptionValue_(c),this.translateMonthAndYear_(c)))}this.monthAndYearSelect_.value=this.getMonthAndYearOptionValue_(i);var d=!this.options_.isDropdownWithOneItemHidden()||h.from<h.to;this.monthAndYearSelect_.style.display=d?"":"none",this.monthAndYearElement_.style.display=d?"none":""}},e.prototype.translateMonthAndYear_=function(t){return this.translateMonth(t.month)+" "+t.year},e.prototype.calculateMonthAndYearIndex_=function(t){return 12*t.year+t.month},e.prototype.getMonthAndYearByIndex_=function(t){return{year:Math.floor(t/12),month:t%12}},e.prototype.getMonthAndYearOptionValue_=function(t){return t.year+"-"+t.month},e.prototype.parseMonthAndYearOptionValue_=function(t){var e=t.split("-");return{month:parseInt(e[1],10),year:parseInt(e[0],10)}},e.prototype.calculateDropdownRange_=function(t,e,n){var i=this.options_.getDropdownItemsLimit()-1,o=Math.ceil(i/2),r=t-(i-o),s=t+o;return r<e?((s+=e-r)>n&&(s=n),r=e):s>n&&((r-=s-n)<e&&(r=e),s=n),{from:r,to:s}},e.prototype.calculateDropdownDiff_=function(t,e,n){for(var i=t.length>0?n(t[0].value):null,o=t.length>0?n(t[t.length-1].value):null,r=[],s=[],a=[],l=e.from;l<=e.to;l++)null===i||l<i?r.push(l):l>o&&s.push(l);for(var h=0;h<t.length;h++){((l=n(t[h].value))<e.from||l>e.to)&&a.push(t[h])}return{prepend:r,append:s,remove:a}},e.prototype.createTableElement_=function(t){var e=this.createTableHeaderElement_(t),n=this.createTableBodyElement_(t);return this.htmlHelper_.createTable_("calendar",e,n)},e.prototype.createTableHeaderElement_=function(t){for(var e=t.getWeekDays_(),n=[],i=0;i<e.length;i++){var o=e[i];n.push(this.createTableHeaderCellElement_(t,o))}return this.htmlHelper_.createTableHeader_("calendar-header",n)},e.prototype.createTableHeaderCellElement_=function(e,n){var i=this.htmlHelper_.createTableHeaderCell_("week-day");return n!==t.DayOfWeek.Saturday&&n!==t.DayOfWeek.Sunday||this.htmlHelper_.addClass_(i,"week-day--weekend"),i.innerText=this.options_.translator.translateDayOfWeek(n),i},e.prototype.createTableBodyElement_=function(t){this.daysElements_=[],this.daysButtonsElements_=[],this.daysContentsElements_=[];for(var e=[],n=0;n<6;n++)e.push(this.createTableRowElement_(t));return this.weeksElements_=e,this.htmlHelper_.createTableBody_("calendar-body",e)},e.prototype.updateWeeksElements_=function(t){for(var e=t.getWeeks_(),n=0;n<this.weeksElements_.length;n++){var i=this.weeksElements_[n],o=e.length>n?e[n]:null;if(i.style.display=o?"":"none",o)for(var r=0;r<this.daysElements_[n].length;r++)this.updateDayElement_(t,this.daysElements_[n][r],this.daysButtonsElements_[n][r],this.daysContentsElements_[n][r],o[r])}},e.prototype.createTableRowElement_=function(t){for(var e=[],n=[],i=[],o=0;o<7;o++){var r=this.htmlHelper_.createTableCell_(),s=this.createTableCellButtonElement_(t),a=this.createTableCellContentElement_(t);e.push(r),n.push(s),i.push(a),r.appendChild(s),s.appendChild(a)}return this.daysElements_.push(e),this.daysButtonsElements_.push(n),this.daysContentsElements_.push(i),this.htmlHelper_.createTableRow_("week",e)},e.prototype.updateDayElement_=function(t,e,n,i,o){if(n.day=o,e.setAttribute("data-date",o.getFormatted()),e.className="",this.htmlHelper_.addClass_(e,"cell"),this.options_.updateCellStructure_(i,o),!o.isVisible)return n.removeAttribute("href"),void(n.style.visibility="hidden");this.htmlHelper_.addClass_(e,"day"),o.isToday&&this.htmlHelper_.addClass_(e,"day--today"),o.isPast&&this.htmlHelper_.addClass_(e,"day--past"),o.isWeekend&&this.htmlHelper_.addClass_(e,"day--weekend"),o.isAvailable||this.htmlHelper_.addClass_(e,"day--unavailable"),o.isInCurrentMonth||this.htmlHelper_.addClass_(e,"day--outside"),o.isHighlighted&&this.htmlHelper_.addClass_(e,"day--highlighted"),o.isSelected&&this.htmlHelper_.addClass_(e,"day--selected");for(var r=this.options_.getCellClasses(o),s=0;s<r.length;s++)e.className+=" "+r[s];n.style.visibility="visible",o.isAvailable?n.href="#":n.removeAttribute("href"),o.isFocused&&n.focus()},e.prototype.createTableCellButtonElement_=function(t){var e=this,n=this.htmlHelper_.createAnchor_((function(i){var o=t.selectedDate_,r=t.selectDay_(i,n.day,!1,!0,!0);e.options_.isHiddenOnSelect()&&(r||o&&n.day.isEqualToDate(o))&&t.close_(i)}));return n.onfocus=function(e){t.highlightDay_(e||window.event,n.day)},n.onmouseenter=function(i){e.options_.getBeforeFocusListeners().length>0||e.options_.getFocusListeners().length>0?t.highlightDay_(i||window.event,n.day,!1,!1):t.cancelHighlight_(i||window.event)},n.onmouseleave=function(e){t.cancelHighlight_(e||window.event)},n},e.prototype.createTableCellContentElement_=function(t){var e=this.options_.getCellStructure_();return this.htmlHelper_.addClass_(e,"day-content"),e},e.prototype.slideMonth_=function(e,n,i){var o=this;if(i?e.canGoForward_():e.canGoBack_()){var r=function(){i?e.goForward_(n):e.goBack_(n)};if(this.options_.isMonthChangeAnimated()&&t.Helper_.isCssAnimationSupported_()){var s=i?"fade-out-left":"fade-out-right",a=i?"fade-in-right":"fade-in-left",l=t.Helper_.addEventListener_(this.bodyElement_,t.ListenerType_.AnimationEnd,(function(e){r(),l(),o.bodyElement_.className=o.options_.prefixClass_("body"),o.htmlHelper_.addClass_(o.bodyElement_,"animated"),o.htmlHelper_.addClass_(o.bodyElement_,a),l=t.Helper_.addEventListener_(o.bodyElement_,t.ListenerType_.AnimationEnd,(function(t){l(),o.bodyElement_.className=o.options_.prefixClass_("body")}))}));this.bodyElement_.className=this.options_.prefixClass_("body"),this.htmlHelper_.addClass_(this.bodyElement_,"animated"),this.htmlHelper_.addClass_(this.bodyElement_,s)}else r()}},e.prototype.translateMonth=function(t){return this.options_.isMonthShort()?this.options_.translator.translateMonthShort(t):this.options_.translator.translateMonth(t)},e}();t.Template_=e}(TheDatepicker||(TheDatepicker={})),function(t){var e;!function(t){t[t.GoBack=0]="GoBack",t[t.GoForward=1]="GoForward",t[t.Close=2]="Close",t[t.Reset=3]="Reset",t[t.Deselect=4]="Deselect"}(e=t.TitleName||(t.TitleName={}));var n=function(){function n(){var t;this.dayOfWeekFullTranslations_=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.dayOfWeekTranslations_=["Su","Mo","Tu","We","Th","Fr","Sa"],this.monthTranslations_=["January","February","March","April","May","June","July","August","September","October","November","December"],this.monthShortTranslations_=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.titles_=((t={})[e.GoBack]="Previous month",t[e.GoForward]="Next month",t[e.Close]="Close",t[e.Reset]="Reset",t[e.Deselect]="Deselect",t)}return n.prototype.setDayOfWeekTranslation=function(e,n){this.dayOfWeekTranslations_[t.Helper_.checkNumber_("Day of week",e,0,6)]=t.Helper_.checkString_("Translation",n)},n.prototype.setDayOfWeekFullTranslation=function(e,n){this.dayOfWeekFullTranslations_[t.Helper_.checkNumber_("Day of week",e,0,6)]=t.Helper_.checkString_("Translation",n)},n.prototype.setMonthTranslation=function(e,n){this.monthTranslations_[t.Helper_.checkNumber_("Month",e,0,11)]=t.Helper_.checkString_("Translation",n)},n.prototype.setMonthShortTranslation=function(e,n){this.monthShortTranslations_[t.Helper_.checkNumber_("Month",e,0,11)]=t.Helper_.checkString_("Translation",n)},n.prototype.setTitleTranslation=function(e,n){this.titles_[e]=t.Helper_.checkString_("Translation",n)},n.prototype.translateDayOfWeek=function(t){return this.dayOfWeekTranslations_[t]},n.prototype.translateDayOfWeekFull=function(t){return this.dayOfWeekFullTranslations_[t]},n.prototype.translateMonth=function(t){return this.monthTranslations_[t]},n.prototype.translateMonthShort=function(t){return this.monthShortTranslations_[t]},n.prototype.translateTitle=function(t){var e=this.titles_[t];if("string"!=typeof e)throw new Error("Unknown title "+t);return e},n}();t.Translator=n}(TheDatepicker||(TheDatepicker={})),function(t){var e;!function(t){t[t.Left=-1]="Left",t[t.Up=-7]="Up",t[t.Right=1]="Right",t[t.Down=7]="Down"}(e=t.MoveDirection_||(t.MoveDirection_={}));var n=function(){function n(e,n,i){this.options_=e,this.datepicker_=n,this.dateConverter_=i,this.selectedDate_=null,this.currentMonth_=null,this.outsideDates_=null,this.highlightedDay_=null,this.isHighlightedDayFocused_=!1,this.active_=!1,this.template_=new t.Template_(this.options_,new t.HtmlHelper_(this.options_),n.container,!!n.input)}return n.prototype.render_=function(){if(!this.datepicker_.isDestroyed()&&!this.selectPossibleDate_()){var t=this.options_.correctMonth(this.getCurrentMonth_());this.goToMonth_(null,t)||(this.template_.render_(this),this.datepicker_.updateInput_())}},n.prototype.setActive_=function(t,e){return this.active_===e||!!this.triggerOnBeforeOpenAndClose_(t,e)&&(this.active_=e,this.options_.isHiddenOnBlur()&&this.render_(),this.triggerOnOpenAndClose_(t,e),!0)},n.prototype.isActive_=function(){return this.active_},n.prototype.close_=function(t){return this.datepicker_.close(t)},n.prototype.getCurrentMonth_=function(){return this.currentMonth_||this.setCurrentMonth_(this.options_.getInitialMonth()),this.currentMonth_},n.prototype.canGoBack_=function(){var t=new Date(this.getCurrentMonth_().getTime());return t.setMonth(t.getMonth()-1),this.canGoToMonth_(t)},n.prototype.canGoForward_=function(){var t=new Date(this.getCurrentMonth_().getTime());return t.setMonth(t.getMonth()+1),this.canGoToMonth_(t)},n.prototype.canGoToMonth_=function(e){return!!t.Helper_.isValidDate_(e)&&this.options_.isMonthInValidity(e)},n.prototype.goBack_=function(t){var e=new Date(this.getCurrentMonth_().getTime());return e.setMonth(e.getMonth()-1),this.goToMonth_(t,e)},n.prototype.goForward_=function(t){var e=new Date(this.getCurrentMonth_().getTime());return e.setMonth(e.getMonth()+1),this.goToMonth_(t,e)},n.prototype.goToMonth_=function(e,n,i){return void 0===i&&(i=!0),(n=t.Helper_.resetTime_(new Date(n.getTime()))).setDate(1),!(n.getTime()===this.getCurrentMonth_().getTime()||!this.canGoToMonth_(n))&&(!!this.triggerOnBeforeMonthChange_(e,n,this.currentMonth_)&&(this.setCurrentMonth_(n),i&&this.cancelHighlight_(e)||this.render_(),this.triggerOnMonthChange_(e,n,this.currentMonth_),!0))},n.prototype.reset_=function(t){var e=this.goToMonth_(t,this.options_.getInitialMonth()),n=this.selectInitialDate_(t);return e||n},n.prototype.selectDay_=function(e,n,i,o,r){if(void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===r&&(r=!1),!n)return this.cancelSelection_(e);var s;if(n instanceof t.Day?n=(s=n).getDate():s=this.createDay_(n),!s.isAvailable)return!1;if(s.isEqualToDate(this.selectedDate_))return!(!r||!this.options_.hasToggleSelection())&&this.cancelSelection_(e);var a=this.selectedDate_?this.createDay_(this.selectedDate_):null;return!!this.triggerOnBeforeSelect_(e,s,a)&&(this.selectedDate_=s.getDate(),o&&this.highlightDay_(e,s),i&&this.goToMonth_(e,n)||this.render_(),this.triggerOnSelect_(e,s,a),!0)},n.prototype.selectNearestDate_=function(t,e){return this.selectDay_(t,this.options_.findNearestAvailableDate(e))},n.prototype.selectPossibleDate_=function(){try{return this.selectDay_(null,this.options_.findPossibleAvailableDate(this.selectedDate_),!1)}catch(e){if(!(e instanceof t.AvailableDateNotFoundException))throw e;return this.cancelSelection_(null,!0)}},n.prototype.selectInitialDate_=function(e){try{return this.selectDay_(e,this.options_.getInitialDate(),!1)}catch(e){if(!(e instanceof t.AvailableDateNotFoundException))throw e;return this.cancelSelection_(null,!0)}},n.prototype.highlightDay_=function(t,e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!0),!e.isAvailable)return!1;if(e.isEqualToDay(this.highlightedDay_))return!1;var o=this.highlightedDay_;if(!this.triggerOnBeforeFocus_(t,e,o))return!1;this.highlightedDay_=e,i&&(this.isHighlightedDayFocused_=!0);var r=e.getDate();return n&&this.goToMonth_(t,r,!1)||this.render_(),this.triggerOnFocus_(t,e,o),!0},n.prototype.highlightFirstAvailableDay_=function(t){for(var e=this.options_.getMaxDate_(),n=this.createDay_(new Date(this.getCurrentMonth_().getTime()));!n.isAvailable;){var i=n.getSibling();if(1===i.dayNumber)break;if(i.getDate().getTime()>e.getTime())break;n=i}return this.highlightDay_(t,n)},n.prototype.highlightSiblingDay_=function(t,e,n){var i=e,o=1e3;do{if(!(i=i.getSibling(n)).isInValidity)break;o--}while(!i.isAvailable&&o>0);return this.highlightDay_(t,i,!0)},n.prototype.cancelSelection_=function(t,e){if(void 0===e&&(e=!1),!this.options_.isAllowedEmpty()&&!e)return!1;if(!this.selectedDate_)return!1;var n=this.createDay_(this.selectedDate_);return!!this.triggerOnBeforeSelect_(t,null,n)&&(this.selectedDate_=null,this.render_(),this.triggerOnSelect_(t,null,n),!0)},n.prototype.cancelHighlight_=function(t){if(!this.highlightedDay_)return!1;var e=this.highlightedDay_;return!!this.triggerOnBeforeFocus_(t,null,e)&&(this.highlightedDay_=null,this.render_(),this.triggerOnFocus_(t,null,e),!0)},n.prototype.getWeekDays_=function(){for(var t=[],e=0;e<7;e++)t.push((this.options_.getFirstDayOfWeek()+e)%7);return t},n.prototype.getWeeks_=function(){for(var t=[],e=this.getCurrentMonth_(),n=this.getOutsideDates_(),i=0;i<n.prepend.length;i++){var o=this.createDay_(n.prepend[i]);t.push(o)}for(var r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),s=1;s<=r;s++)t.push(this.createDay_(new Date(e.getFullYear(),e.getMonth(),s)));for(i=0;i<n.append.length;i++){o=this.createDay_(n.append[i]);t.push(o)}for(var a=[],l=0;l<t.length;l+=7)a.push(t.slice(l,l+7));return a},n.prototype.triggerKeyPress_=function(e){t.Helper_.inArray_([t.KeyCode_.Left,t.KeyCode_.Up,t.KeyCode_.Right,t.KeyCode_.Down],e.keyCode)&&(t.Helper_.preventDefault_(e),this.highlightedDay_?this.highlightSiblingDay_(e,this.highlightedDay_,this.translateKeyCodeToMoveDirection_(e.keyCode)):this.selectedDate_&&this.selectedDate_.getFullYear()===this.getCurrentMonth_().getFullYear()&&this.selectedDate_.getMonth()===this.getCurrentMonth_().getMonth()?this.highlightSiblingDay_(e,this.createDay_(this.selectedDate_),this.translateKeyCodeToMoveDirection_(e.keyCode)):this.highlightFirstAvailableDay_(e))},n.prototype.createDay_=function(e){var n=this;e=t.Helper_.resetTime_(new Date(e.getTime()));var i=this.options_.getToday(),o=this.getCurrentMonth_(),r=new t.Day(e,(function(t){return n.createDay_(t)}),(function(t){return n.dateConverter_.formatDate_(n.options_.getInputFormat(),t)}));if(r.isToday=e.getTime()===i.getTime(),r.isPast=e.getTime()<i.getTime(),r.isInValidity=this.options_.isDateInValidity(e),r.isAvailable=r.isInValidity&&this.options_.isDateAvailable(e),r.isInCurrentMonth=e.getMonth()===o.getMonth(),r.isInCurrentMonth)r.isVisible=!0;else if(this.options_.areDaysOutOfMonthVisible())for(var s=this.getOutsideDates_(),a=s.prepend.concat(s.append),l=0;l<a.length;l++)if(e.getTime()===a[l].getTime()){r.isVisible=!0;break}return r.isAvailable&&(r.isEqualToDate(this.selectedDate_)&&(r.isSelected=!0),r.isEqualToDay(this.highlightedDay_)&&(r.isHighlighted=!0,this.isHighlightedDayFocused_&&(r.isFocused=!0,this.isHighlightedDayFocused_=!1))),this.options_.modifyDay(r),r},n.prototype.triggerOnBeforeSelect_=function(e,n,i){var o=this;return this.options_.triggerEvent_(t.EventType_.BeforeSelect,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.triggerOnSelect_=function(e,n,i){var o=this;this.options_.triggerEvent_(t.EventType_.Select,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.triggerOnBeforeOpenAndClose_=function(e,n){var i=this;return this.options_.triggerEvent_(t.EventType_.BeforeOpenAndClose,(function(t){return t.call(i.datepicker_,e,n)}))},n.prototype.triggerOnOpenAndClose_=function(e,n){var i=this;this.options_.triggerEvent_(t.EventType_.OpenAndClose,(function(t){return t.call(i.datepicker_,e,n)}))},n.prototype.triggerOnBeforeMonthChange_=function(e,n,i){var o=this;return this.options_.triggerEvent_(t.EventType_.BeforeMonthChange,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.triggerOnMonthChange_=function(e,n,i){var o=this;this.options_.triggerEvent_(t.EventType_.MonthChange,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.triggerOnBeforeFocus_=function(e,n,i){var o=this;return this.options_.triggerEvent_(t.EventType_.BeforeFocus,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.triggerOnFocus_=function(e,n,i){var o=this;this.options_.triggerEvent_(t.EventType_.Focus,(function(t){return t.call(o.datepicker_,e,n,i)}))},n.prototype.setCurrentMonth_=function(t){this.currentMonth_=t,this.outsideDates_=null},n.prototype.getOutsideDates_=function(){if(this.outsideDates_)return this.outsideDates_;for(var t=this.getCurrentMonth_(),e=this.options_.getFirstDayOfWeek(),n=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth(),0).getDate(),o=(n.getDay()-e+7)%7,r=[],s=i-o+1;s<=i;s++)r.push(new Date(t.getFullYear(),t.getMonth()-1,s));var a=new Date(t.getFullYear(),t.getMonth()+1,0),l=6-(a.getDay()-e+7)%7,h=[];for(s=1;s<=l;s++)h.push(new Date(t.getFullYear(),t.getMonth()+1,s));if(this.options_.hasFixedRowsCount()){var p=a.getDate();for(s=l+1;o+p+h.length<42;s++)h.push(new Date(t.getFullYear(),t.getMonth()+1,s))}return this.outsideDates_={prepend:r,append:h},this.outsideDates_},n.prototype.translateKeyCodeToMoveDirection_=function(n){switch(n){case t.KeyCode_.Left:return e.Left;case t.KeyCode_.Up:return e.Up;case t.KeyCode_.Right:return e.Right;case t.KeyCode_.Down:return e.Down;default:throw new Error("Invalid key code: "+n)}},n}();t.ViewModel_=n}(TheDatepicker||(TheDatepicker={}));
